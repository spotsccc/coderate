function t(t){switch(t=String(t)){case'__proto__':case'__defineGetter__':case'__defineSetter__':case'constructor':case'prototype':case'hasOwnProperty':case'toString':case'valueOf':case'setProperty':case'removeProperty':return'forbidden';default:return t.replace(/[^a-zA-Z0-9\-_]/g,'')}}function e(t,e){t.sibling.right=e,t.nextSibling=e}function i(t){return`-${t.toLowerCase()}`}function s(t){switch(t){case'&':return'&amp;';case'<':return'&lt;';case'>':return'&gt;';case'"':return'&quot;';case"'":return'&#39;';default:return t}}function n(t){return String(t).replace(c,'')}function l(e,r){if(null!==e.textContent){let t=e.textContent;e.parent&&'script'===e.parent.tagName||(t=String(t).replace(u,s)),r.push(t)}if(e.isFragment){let t=e.firstChild;for(;t;)l(t,r),t=t.sibling.right;return}r.push('<',e.tagName);for(let t in e.attributes)r.push(' ',t,'=','"',n(e.attributes[t]),'"');for(let s in e.dataset)r.push(' ','data-',t(s).replace(g,i),'=','"',n(e.dataset[s]),'"');let h=[];for(let t in e.style){let i=e.style[t];if(t.startsWith('--'))h.push(`${t}: ${i}`);else{let e=t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`));(t.startsWith('webkit')||t.startsWith('moz'))&&(e=`-${e}`),h.push(`${e}: ${i}`)}}if(h.length>0&&r.push(' ','style','=','"',h.join(';'),'"'),r.push('>'),d.includes(e.tagName))return;let a='script'===e.tagName?[]:r,c=e.firstChild;for(;c;)l(c,a),c=c.sibling.right;if('script'===e.tagName){let t=a.join('');r.push(t.replace(o,'<\\/script'))}r.push('</',e.tagName,'>')}function r(t){let e=[];l(t,e);let i=e.join('');return h(t)?`<!DOCTYPE html>${i}`:i}function h(t){if('html'===t.tagName)return 1;if(t.isFragment&&null===t.textContent){let e=t.firstChild;if(e&&t.child.last===e)return h(e)}return 0}Object.defineProperty(exports,'__esModule',{value:1});var a=require('forest');const c=/[\\<>"]/g,g=/[A-Z]/g,u=/[&<>'"]/g,o=/<\/(\s|\\n)*script/gim;class f{constructor(){this.child={first:null,last:null},this.sibling={left:null,right:null},this.parent=null,this.tagName='',this.nodeName='',this.namespaceURI='http://www.w3.org/1999/xhtml',this.dataset=Object.create(null),this.style=new p,this.value=void 0,this.firstChild=null,this.nextSibling=null,this.isFragment=1,this.attributes=Object.create(null),this.textContent=null,this.__STATIC__=1}cloneNode(){let t=new f;return t.tagName=this.tagName,t.nodeName=this.nodeName,t.namespaceURI=this.namespaceURI,Object.assign(t.dataset,this.dataset),Object.assign(t.style,this.style),t.value=this.value,t.isFragment=this.isFragment,Object.assign(t.attributes,this.attributes),t.textContent=this.textContent,t}after(t){this.sibling.right!==t&&(t.parent&&t.remove(),this.parent&&(this.sibling.right?(this.sibling.right.sibling.left=t,e(t,this.sibling.right)):this.parent.child.last=t,e(this,t),t.sibling.left=this,t.parent=this.parent))}prepend(t){t.parent&&t.remove(),this.child.last?(this.child.first.sibling.left=t,e(t,this.child.first)):(this.child.first=t,this.child.last=t),this.child.first=t,this.firstChild=t,t.parent=this}remove(){if(!this.parent)return;let{parent:t}=this;t.child.first===this&&t.child.last===this?(t.firstChild=null,t.child.first=null,t.child.last=null):t.child.first===this?(t.child.first=this.sibling.right,t.firstChild=this.sibling.right,this.sibling.right.sibling.left=null):t.child.last===this?(t.child.last=this.sibling.left,e(this.sibling.left,null)):(this.sibling.right.sibling.left=this.sibling.left,e(this.sibling.left,this.sibling.right)),this.sibling.left=null,e(this,null),this.parent=null}addEventListener(t,e,i){}removeEventListener(t,e,i){}setAttribute(e,i){this.attributes[t(e)]=n(i)}removeAttribute(e){delete this.attributes[t(e)]}replaceWith(t){if(!this.parent)return;let{parent:i}=this;t.parent&&t.remove(),i.child.first===this&&i.child.last===this?(i.firstChild=t,i.child.first=t,i.child.last=t):i.child.first===this?(i.child.first=t,i.firstChild=t,this.sibling.right.sibling.left=t):i.child.last===this?(i.child.last=t,e(this.sibling.left,t)):(this.sibling.right.sibling.left=t,e(this.sibling.left,t)),t.sibling.left=this.sibling.left,e(t,this.sibling.right),t.parent=i,this.sibling.left=null,e(this,null),this.parent=null}replaceData(t,e,i){'string'==typeof this.textContent&&(this.textContent=`${this.textContent.slice(0,t)}${i}${this.textContent.slice(t+e)}`)}splitText(t){if('string'!=typeof this.textContent)return null;let e=new f;return e.nodeName='#text',e.textContent=this.textContent.slice(t),this.textContent=this.textContent.slice(0,t),this.after(e),e}}class p{setProperty(e,i){this[t(e)]=n(i)}removeProperty(e){delete this[t(e)]}}const d=['area','base','br','col','embed','hr','img','input','keygen','link','meta','param','source','track','wbr'];exports.renderStatic=e=>{let i,s={document:{createTextNode(t){let e=new f;return e.textContent=String(t),e.nodeName='#text',e},createElement(e){let i=new f;return i.tagName=t(e),i.isFragment=0,i},createElementNS(e,i){switch(e){case'http://www.w3.org/1999/xhtml':case'http://www.w3.org/2000/svg':break;default:e='http://www.w3.org/1999/xhtml'}let s=new f;return s.tagName=t(i),s.namespaceURI=e,s.isFragment=0,s},createDocumentFragment:()=>new f}},n=s.document.createDocumentFragment();return'object'==typeof e&&null!==e&&(i=e.scope,e=e.fn),new Promise((t=>{a.using(n,{fn:e,env:s,scope:i,onComplete(){t(r(n))}})}))};
//# sourceMappingURL=server.js.map
