import{is as o,createNode as e,step as n}from"effector/effector.mjs";import*as t from"effector-inspector/index.mjs";import s from"just-debounce-it";import c from"detect-node";import i from"set-value";const l="@effector-logger";function a(o){return o.path.filter((o=>"@effector-logger"!==o)).join("/")}function r(o){var e,n,t;return null!==(t=null===(n=null===(e=o.defaultConfig)||void 0===e?void 0:e.loc)||void 0===n?void 0:n.file)&&void 0!==t?t:" "}function f(t,s,c){o.domain(s,{loc:{file:"/src/lib.ts",line:31,column:8},sid:"-5xrbn0"})?function(e,n,t){o.store(e,{loc:{file:"/src/lib.ts",line:11,column:8},sid:"-6vukfe"})&&t(e.getState()),(o.store(e,{loc:{file:"/src/lib.ts",line:14,column:22},name:"watchUnit",sid:"-tu8c8a"})?e.updates:e).watch(t)}(t,0,c):function(t,s,c){o.store(t,{loc:{file:"/src/lib.ts",line:18,column:8},sid:"-6s009v"})&&c(s.getState(t));const i=e({node:[n.run({fn:c})]}),l=(o.store(t,{loc:{file:"/src/lib.ts",line:24,column:22},name:"watchUnit",sid:"-f5u209"})?t.updates:t).graphite.id;(s.additionalLinks[l]=s.additionalLinks[l]||[]).push(i)}(t,s,c)}const d=c?"  ":"",p=[],u=[],m=[],g="padding-left: 4px; padding-right: 4px; font-weight: normal;",h="padding-left: 4px; padding-right: 4px; font-weight: normal;",b="background-color: #7e57c2; color: #fff",v="background-color: #9ccc65; color: #000",E="background-color: #26a69a; color: #000",$="",x="color: #9e9e9e; padding-left: 20px;",w="color: currentColor; background-color: transparent;",y=[["☄️","%s",'line-height:1.5; color: #000; font-family: "Apple Emoji Font"; font-weight: normal !important;'],["effector","%s","font-family: Menlo, monospace;"]];function N(o,e,n){const t=[],s=[];o.unshift(...y),o.forEach((([e,n,c],i)=>{t.push(`%c${n}%c`),s.push(`${g} ${c}`,e,((o,e,n)=>o===e-1?w:n)(i,o.length,`${g} ${c}`))})),e.forEach((([o,e,n])=>{t.push(`%c${e}`),s.push(`${h} ${n}`,o)}));const c=[t.join(d),...s];"open"===n?console.group(...c):"collapsed"===n?console.groupCollapsed(...c):console.log(...c)}const S=["new","%s","background-color: #29b6f6; color: #000"],j=o=>o.split("/").pop()||o,k=o=>[j(o),"%s",b],C=o=>[j(o),"%s",v],O=o=>[j(o),"%s",E],_=s((()=>{const o=p.splice(0),e=u.splice(0),n=m.splice(0);o.length+e.length+n.length>0&&(N([S],[["Initialized","%s",""],[`events(${e.length})`,"%s",""],[`effects(${n.length})`,"%s",""],[`stores(${o.length})`,"%s",""]],"collapsed"),o.length&&o.forEach((o=>{const e=a(o.compositeName),n=r(o);N([S,k(e)],[["-> ","%s",""],[o.getState(),"%o",""],[n,"%s",x],[e,"%s",""]])})),e.length>0&&e.forEach((o=>{const e=a(o.compositeName),n=r(o);N([S,C(e)],[[n,"%s",x],[e,"%s",""]])})),n.length>0&&n.forEach((o=>{const e=a(o.compositeName),n=r(o);N([S,O(e)],[[n,"%s",x],[e,"%s",""]])})),console.groupEnd())}),5);const D="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;const F={instanceId:"object"==typeof document?`☄️ ${document.title}`:"☄️ no title instance"},I={};function L(o,e){i(I,o.replace(/\//g,"."),e)}function U(o,e){L(o,{inFlight:e.inFlight.getState(),pending:e.pending.getState()})}const z={reduxDevtools:"enabled",console:"enabled",inspector:"enabled"};function T(e,n={}){const s=Object.assign(Object.assign({},z),n),c="enabled"===s.console,i="enabled"===s.reduxDevtools,l="enabled"===s.inspector;function d(o){const n=a(o.compositeName),s=r(o);c&&function(o){u.push(o),_()}(o),l&&t.addEvent(o),f(o,e,(o=>{c&&function(o,e,n){N([C(o)],[[n,"%o","padding-left: 4px;"],[e,"%s",x],[o,"%s",x]])}(n,s,o),i&&function(o,e){D&&D.send({type:`${o} (event)`,payload:e},I,F)}(n,o)}))}function g(o){const n=a(o.compositeName),s=r(o);c&&function(o){p.push(o),_()}(o),i&&function(o){L(a(o.compositeName),o.defaultState)}(o),l&&t.addStore(o);const d=o.map.bind(o);o.map=(e,n)=>{const s=d(e,n);return s.compositeName.path=o.compositeName.path.slice(0,-1),s.compositeName.path.push(o.compositeName.path.slice(-1)+" -> *"),l&&t.addStore(s,{mapped:!0}),s},f(o,e,(o=>{c&&function(o,e,n){N([k(o)],[["-> ","%s",""],[n,"%o",""],[e,"%s",x],[o,"%s",x]])}(n,s,o),i&&function(o,e){L(o,e),D&&D.send({type:`${o} (store updated)`,value:e},I,F)}(n,o)}))}function h(o){const n=a(o.compositeName),s=r(o);c&&function(o){m.push(o),_()}(o),i&&function(o,e){U(o,e)}(n,o),l&&t.addEffect(o),f(o,e,(e=>{c&&function(o,e,n){N([O(o)],[[n,"%o","padding-left: 4px;"],[e,"%s",x],[o,"%s",x]])}(n,s,e),i&&function(o,e,n){U(o,e),D&&D.send({type:`${o} (effect called)`,params:n},I,F)}(n,o,e)})),f(o.done,e,(({params:e,result:t})=>{c&&function(o,e,n,t){N([O(o)],[["done ✅","%s",$],[n,"(%o)","padding-left: 4px;"],["-> ","%s",""],[t,"%o","padding: 0;"],[e,"%s",x],[o,"%s",x]])}(n,s,e,t),i&&function(o,e,n,t){U(o,e),D&&D.send({type:`${o}.done (effect finished)`,params:n,result:t},I,F)}(n,o,e,t)})),f(o.fail,e,(({params:e,error:t})=>{c&&function(o,e,n,t){const s=t instanceof Error;N([O(o)],[["fail ❌","%s",$],[n,"(%o)","padding-left: 4px;"],["-> ","%s",""],s?[String(t),"%s",""]:[t,"%o","padding: 0;"],[e,"%s",x],[o,"%s",x]],s?"collapsed":void 0),s&&N([],[[" ","%s",""],[t,"%o","padding-left: 20px;"]]),console.groupEnd()}(n,s,e,t),i&&function(o,e,n,t){U(o,e),D&&D.send({type:`${o}.fail (effect finished)`,params:n,error:t},I,F)}(n,o,e,t)}))}if(o.domain(e,{loc:{file:"/src/attach.ts",line:89,column:8},sid:"4o82wz"}))e.onCreateEvent(d),e.onCreateStore(g),e.onCreateEffect(h);else{const o=e.cloneOf;if(void 0===o)throw new Error("Scope should be created from domain");for(const e of o.history.events)d(e);for(const e of o.history.effects)h(e);for(const e of o.history.stores)g(e)}}export{l as LOGGER_DOMAIN_NAME,T as attachLogger};
//# sourceMappingURL=attach.mjs.map
