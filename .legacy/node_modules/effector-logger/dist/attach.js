"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("effector"),o=require("effector-inspector"),t=require("just-debounce-it"),n=require("detect-node"),s=require("set-value");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var o=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(o,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),o.default=e,Object.freeze(o)}var r=i(o),a=c(t),f=c(n),l=c(s);function d(e){return e.path.filter((e=>"@effector-logger"!==e)).join("/")}function p(e){var o,t,n;return null!==(n=null===(t=null===(o=e.defaultConfig)||void 0===o?void 0:o.loc)||void 0===t?void 0:t.file)&&void 0!==n?n:" "}function u(o,t,n){e.is.domain(t)?function(o,t,n){e.is.store(o)&&n(o.getState()),(e.is.store(o)?o.updates:o).watch(n)}(o,0,n):function(o,t,n){e.is.store(o)&&n(t.getState(o));const s=e.createNode({node:[e.step.run({fn:n})]}),c=(e.is.store(o)?o.updates:o).graphite.id;(t.additionalLinks[c]=t.additionalLinks[c]||[]).push(s)}(o,t,n)}const g=f.default?"  ":"",h=[],m=[],b=[],v="padding-left: 4px; padding-right: 4px; font-weight: normal;",E="padding-left: 4px; padding-right: 4px; font-weight: normal;",y="background-color: #7e57c2; color: #fff",$="background-color: #9ccc65; color: #000",N="background-color: #26a69a; color: #000",x="",O="color: #9e9e9e; padding-left: 20px;",j="color: currentColor; background-color: transparent;",S=[["☄️","%s",'line-height:1.5; color: #000; font-family: "Apple Emoji Font"; font-weight: normal !important;'],["effector","%s","font-family: Menlo, monospace;"]];function w(e,o,t){const n=[],s=[];e.unshift(...S),e.forEach((([o,t,c],i)=>{n.push(`%c${t}%c`),s.push(`${v} ${c}`,o,((e,o,t)=>e===o-1?j:t)(i,e.length,`${v} ${c}`))})),o.forEach((([e,o,t])=>{n.push(`%c${o}`),s.push(`${E} ${t}`,e)}));const c=[n.join(g),...s];"open"===t?console.group(...c):"collapsed"===t?console.groupCollapsed(...c):console.log(...c)}const _=["new","%s","background-color: #29b6f6; color: #000"],k=e=>e.split("/").pop()||e,C=e=>[k(e),"%s",y],D=e=>[k(e),"%s",$],q=e=>[k(e),"%s",N],L=a.default((()=>{const e=h.splice(0),o=m.splice(0),t=b.splice(0);e.length+o.length+t.length>0&&(w([_],[["Initialized","%s",""],[`events(${o.length})`,"%s",""],[`effects(${t.length})`,"%s",""],[`stores(${e.length})`,"%s",""]],"collapsed"),e.length&&e.forEach((e=>{const o=d(e.compositeName),t=p(e);w([_,C(o)],[["-> ","%s",""],[e.getState(),"%o",""],[t,"%s",O],[o,"%s",""]])})),o.length>0&&o.forEach((e=>{const o=d(e.compositeName),t=p(e);w([_,D(o)],[[t,"%s",O],[o,"%s",""]])})),t.length>0&&t.forEach((e=>{const o=d(e.compositeName),t=p(e);w([_,q(o)],[[t,"%s",O],[o,"%s",""]])})),console.groupEnd())}),5);const M="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;const I={instanceId:"object"==typeof document?`☄️ ${document.title}`:"☄️ no title instance"},A={};function F(e,o){l.default(A,e.replace(/\//g,"."),o)}function P(e,o){F(e,{inFlight:o.inFlight.getState(),pending:o.pending.getState()})}const z={reduxDevtools:"enabled",console:"enabled",inspector:"enabled"};exports.LOGGER_DOMAIN_NAME="@effector-logger",exports.attachLogger=function(o,t={}){const n=Object.assign(Object.assign({},z),t),s="enabled"===n.console,c="enabled"===n.reduxDevtools,i="enabled"===n.inspector;function a(e){const t=d(e.compositeName),n=p(e);s&&function(e){m.push(e),L()}(e),i&&r.addEvent(e),u(e,o,(e=>{s&&function(e,o,t){w([D(e)],[[t,"%o","padding-left: 4px;"],[o,"%s",O],[e,"%s",O]])}(t,n,e),c&&function(e,o){M&&M.send({type:`${e} (event)`,payload:o},A,I)}(t,e)}))}function f(e){const t=d(e.compositeName),n=p(e);s&&function(e){h.push(e),L()}(e),c&&function(e){F(d(e.compositeName),e.defaultState)}(e),i&&r.addStore(e);const a=e.map.bind(e);e.map=(o,t)=>{const n=a(o,t);return n.compositeName.path=e.compositeName.path.slice(0,-1),n.compositeName.path.push(e.compositeName.path.slice(-1)+" -> *"),i&&r.addStore(n,{mapped:!0}),n},u(e,o,(e=>{s&&function(e,o,t){w([C(e)],[["-> ","%s",""],[t,"%o",""],[o,"%s",O],[e,"%s",O]])}(t,n,e),c&&function(e,o){F(e,o),M&&M.send({type:`${e} (store updated)`,value:o},A,I)}(t,e)}))}function l(e){const t=d(e.compositeName),n=p(e);s&&function(e){b.push(e),L()}(e),c&&function(e,o){P(e,o)}(t,e),i&&r.addEffect(e),u(e,o,(o=>{s&&function(e,o,t){w([q(e)],[[t,"%o","padding-left: 4px;"],[o,"%s",O],[e,"%s",O]])}(t,n,o),c&&function(e,o,t){P(e,o),M&&M.send({type:`${e} (effect called)`,params:t},A,I)}(t,e,o)})),u(e.done,o,(({params:o,result:i})=>{s&&function(e,o,t,n){w([q(e)],[["done ✅","%s",x],[t,"(%o)","padding-left: 4px;"],["-> ","%s",""],[n,"%o","padding: 0;"],[o,"%s",O],[e,"%s",O]])}(t,n,o,i),c&&function(e,o,t,n){P(e,o),M&&M.send({type:`${e}.done (effect finished)`,params:t,result:n},A,I)}(t,e,o,i)})),u(e.fail,o,(({params:o,error:i})=>{s&&function(e,o,t,n){const s=n instanceof Error;w([q(e)],[["fail ❌","%s",x],[t,"(%o)","padding-left: 4px;"],["-> ","%s",""],s?[String(n),"%s",""]:[n,"%o","padding: 0;"],[o,"%s",O],[e,"%s",O]],s?"collapsed":void 0),s&&w([],[[" ","%s",""],[n,"%o","padding-left: 20px;"]]),console.groupEnd()}(t,n,o,i),c&&function(e,o,t,n){P(e,o),M&&M.send({type:`${e}.fail (effect finished)`,params:t,error:n},A,I)}(t,e,o,i)}))}if(e.is.domain(o))o.onCreateEvent(a),o.onCreateStore(f),o.onCreateEffect(l);else{const e=o.cloneOf;if(void 0===e)throw new Error("Scope should be created from domain");for(const o of e.history.events)a(o);for(const o of e.history.effects)l(o);for(const o of e.history.stores)f(o)}};
//# sourceMappingURL=attach.js.map
