{"version":3,"file":"attach.js","sources":["../src/lib.ts","../src/logger.ts","../src/redux-devtools.ts","../src/attach.ts"],"sourcesContent":["import {\n  createNode,\n  is,\n  step,\n  Domain,\n  Scope,\n  CompositeName,\n  Unit, Node,\n} from 'effector';\n\nexport const LOGGER_DOMAIN_NAME = '@effector-logger';\n\nexport function createName(composite: CompositeName): string {\n  return composite.path.filter((name) => name !== LOGGER_DOMAIN_NAME).join('/');\n}\n\nexport function getPath(unit: Unit<any>): string {\n  return (unit as any).defaultConfig?.loc?.file ?? ' ';\n}\n\nfunction watchDomain(\n  unit: Unit<any>,\n  domain: Domain,\n  fn: (payload: any) => any,\n): void {\n  if (is.store(unit)) {\n    fn(unit.getState());\n  }\n  const watchUnit = is.store(unit) ? unit.updates : unit;\n  (watchUnit as any).watch(fn);\n}\n\nfunction watchScope(\n  unit: Unit<any>,\n  scope: Scope,\n  fn: (payload: any) => any,\n): void {\n  if (is.store(unit)) {\n    fn(scope.getState(unit));\n  }\n  const node = createNode({\n    node: [step.run({ fn })]\n  });\n  const watchUnit = is.store(unit) ? unit.updates : unit;\n  const id = (watchUnit as any).graphite.id;\n  const links: Node[] = ((scope as any).additionalLinks[id] =\n    (scope as any).additionalLinks[id] || []);\n  links.push(node);\n}\n\nexport function watch(\n  unit: Unit<any>,\n  source: Domain | Scope,\n  fn: (payload: any) => any,\n): void {\n  if (is.domain(source)) {\n    watchDomain(unit, source, fn);\n  } else {\n    watchScope(unit, source, fn);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport debounce from 'just-debounce-it';\nimport isNode from 'detect-node';\nimport { Effect, Event, Store } from 'effector';\nimport { createName, getPath } from './lib';\n\nconst SEPARATOR = isNode ? '  ' : '';\n\nconst storeListToInit: Array<Store<any>> = [];\nconst eventListToInit: Array<Event<any>> = [];\nconst effectListToInit: Array<Effect<any, any, any>> = [];\n\nconst styles = {\n  block: 'padding-left: 4px; padding-right: 4px; font-weight: normal;',\n  chunk: 'padding-left: 4px; padding-right: 4px; font-weight: normal;',\n  effector:\n    'line-height:1.5; color: #000; font-family: \"Apple Emoji Font\"; font-weight: normal !important;',\n  new: 'background-color: #29b6f6; color: #000',\n  store: 'background-color: #7e57c2; color: #fff',\n  event: 'background-color: #9ccc65; color: #000',\n  effect: 'background-color: #26a69a; color: #000',\n  emoji: '',\n  file: 'color: #9e9e9e; padding-left: 20px;',\n  reset: 'color: currentColor; background-color: transparent;',\n};\n\nconst effectorLabel: Block[] = [\n  ['☄️', '%s', styles.effector],\n  ['effector', '%s', 'font-family: Menlo, monospace;']\n];\n\nconst reset = (index: number, count: number, style: string): string =>\n  index === count - 1 ? styles.reset : style;\n\ntype Block = [string, string, string];\ntype Chunk = [any, string, string];\n\nfunction log(\n  blocks: Block[],\n  chunks: Chunk[],\n  group: 'collapsed' | 'open' | void = undefined,\n): void {\n  const str: string[] = [];\n  const params: any[] = [];\n\n  blocks.unshift(...effectorLabel);\n\n  blocks.forEach(([value, view, style], index) => {\n    str.push(`%c${view}%c`);\n    params.push(\n      `${styles.block} ${style}`,\n      value,\n      reset(index, blocks.length, `${styles.block} ${style}`),\n    );\n  });\n\n  chunks.forEach(([value, view, style]) => {\n    str.push(`%c${view}`);\n    params.push(`${styles.chunk} ${style}`, value);\n  });\n\n  const args = [str.join(SEPARATOR), ...params];\n\n  if (group === 'open') {\n    console.group(...args);\n  } else if (group === 'collapsed') {\n    console.groupCollapsed(...args);\n  } else {\n    console.log(...args);\n  }\n}\n\nconst blockNew: Block = ['new', '%s', styles.new];\n\nconst blockStore: Block = ['store', '%s', styles.store];\nconst blockEvent: Block = ['event', '%s', styles.event];\nconst blockEffect: Block = ['effect', '%s', styles.effect];\n\nconst stripDomain = (name: string) => name.split('/').pop() || name;\n\nconst createBlockStore: (name: string) => Block = (name) => [stripDomain(name), '%s', styles.store];\nconst createBlockEvent: (name: string) => Block =  (name) => [stripDomain(name), '%s', styles.event];\nconst createBlockEffect: (name: string) => Block = (name) => [stripDomain(name), '%s', styles.effect];\n\nconst logAdded = debounce(() => {\n  const stores = storeListToInit.splice(0);\n  const events = eventListToInit.splice(0);\n  const effects = effectListToInit.splice(0);\n\n  if (stores.length + events.length + effects.length > 0) {\n    log(\n      [blockNew],\n      [\n        ['Initialized', '%s', ''],\n        [`events(${events.length})`, '%s', ''],\n        [`effects(${effects.length})`, '%s', ''],\n        [`stores(${stores.length})`, '%s', ''],\n      ],\n      'collapsed',\n    );\n\n    if (stores.length) {\n      stores.forEach((store) => {\n        const name = createName(store.compositeName);\n        const fileName = getPath(store);\n\n        log(\n          [blockNew, createBlockStore(name)],\n          [\n            ['-> ', '%s', ''],\n            [store.getState(), '%o', ''],\n            [fileName, '%s', styles.file],\n            [name, '%s', ''],\n          ],\n        );\n      });\n    }\n    if (events.length > 0) {\n      events.forEach((event) => {\n        const name = createName(event.compositeName);\n        const fileName = getPath(event);\n\n        log(\n          [blockNew, createBlockEvent(name)],\n          [\n            [fileName, '%s', styles.file],\n            [name, '%s', ''],\n          ],\n        );\n      });\n    }\n    if (effects.length > 0) {\n      effects.forEach((effect) => {\n        const name = createName(effect.compositeName);\n        const fileName = getPath(effect);\n\n        log(\n          [blockNew, createBlockEffect(name)],\n          [\n            [fileName, '%s', styles.file],\n            [name, '%s', ''],\n          ],\n        );\n      });\n    }\n    console.groupEnd();\n  }\n}, 5);\n\nexport function storeAdded(store: Store<any>): void {\n  storeListToInit.push(store);\n  logAdded();\n}\n\nexport function eventAdded(event: Event<any>): void {\n  eventListToInit.push(event);\n  logAdded();\n}\n\nexport function effectAdded(effect: Effect<any, any, any>): void {\n  effectListToInit.push(effect);\n  logAdded();\n}\n\nexport function storeUpdated(name: string, fileName: string, value: any): void {\n  log(\n    [createBlockStore(name)],\n    [\n      ['-> ', '%s', ''],\n      [value, '%o', ''],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n  );\n}\n\nexport function eventCalled(\n  name: string,\n  fileName: string,\n  payload: any,\n): void {\n  log(\n    [createBlockEvent(name)],\n    [\n      [payload, '%o', 'padding-left: 4px;'],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n  );\n}\n\nexport function effectCalled(\n  name: string,\n  fileName: string,\n  parameters: any,\n): void {\n  log(\n    [createBlockEffect(name)],\n    [\n      [parameters, '%o', 'padding-left: 4px;'],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n  );\n}\n\nexport function effectDone(\n  name: string,\n  fileName: string,\n  parameters: any,\n  result: any,\n): void {\n  log(\n    [createBlockEffect(name)],\n    [\n      ['done ✅', '%s', styles.emoji],\n      [parameters, '(%o)', 'padding-left: 4px;'],\n      ['-> ', '%s', ''],\n      [result, '%o', 'padding: 0;'],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n  );\n}\n\nexport function effectFail(\n  name: string,\n  fileName: string,\n  parameters: any,\n  error: any,\n): void {\n  const instanceofError = error instanceof Error;\n\n  log(\n    [createBlockEffect(name)],\n    [\n      ['fail ❌', '%s', styles.emoji],\n      [parameters, '(%o)', 'padding-left: 4px;'],\n      ['-> ', '%s', ''],\n      instanceofError\n        ? [String(error), '%s', '']\n        : [error, '%o', 'padding: 0;'],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n    instanceofError ? 'collapsed' : undefined,\n  );\n\n  if (instanceofError) {\n    log(\n      [],\n      [\n        [' ', '%s', ''],\n        [error, '%o', 'padding-left: 20px;'],\n      ],\n    );\n  }\n\n  console.groupEnd();\n}\n","import * as effector from 'effector';\nimport set from 'set-value';\nimport { createName } from './lib';\n\n/* eslint-disable @typescript-eslint/ban-ts-ignore, @typescript-eslint/no-explicit-any */\nconst reduxDevTools =\n  // @ts-ignore\n  typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__;\n\nfunction instanceId(): string {\n  if (typeof document === 'object') {\n    return `☄️ ${document.title}`\n  }\n  return '☄️ no title instance'\n}\n\nconst devToolConfig = {\n  instanceId: instanceId(),\n} as unknown as { swallowErrors?: boolean };\n\nconst rootState: Record<string, any> = {};\n\nfunction setState(name: string, value: any): void {\n  set(rootState, name.replace(/\\//g, '.'), value);\n}\n\nexport function eventCalled(name: string, payload: any): void {\n  if (reduxDevTools) {\n    reduxDevTools.send({\n        type: `${name} (event)`,\n        payload,\n      },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n\nexport function storeAdded(store: effector.Store<any>): void {\n  const name = createName(store.compositeName);\n\n  setState(name, store.defaultState);\n}\n\nexport function storeUpdated(name: string, value: any): void {\n  setState(name, value);\n\n  if (reduxDevTools) {\n    reduxDevTools.send({\n        type: `${name} (store updated)`,\n        value,\n      },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n\ntype Effect = effector.Effect<any, any, any>;\n\nfunction effectUpdateState(name: string, effect: Effect): void {\n  setState(name, {\n    inFlight: effect.inFlight.getState(),\n    pending: effect.pending.getState(),\n  });\n}\n\nexport function effectAdded(name: string, effect: Effect): void {\n  effectUpdateState(name, effect);\n}\n\nexport function effectCalled(\n  name: string,\n  effect: Effect,\n  parameters: any,\n): void {\n  effectUpdateState(name, effect);\n\n  if (reduxDevTools) {\n    reduxDevTools.send(\n      { type: `${name} (effect called)`, params: parameters },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n\nexport function effectDone(\n  name: string,\n  effect: Effect,\n  parameters: any,\n  result: any,\n): void {\n  effectUpdateState(name, effect);\n\n  if (reduxDevTools) {\n    reduxDevTools.send(\n      { type: `${name}.done (effect finished)`, params: parameters, result },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n\nexport function effectFail(\n  name: string,\n  effect: Effect,\n  parameters: any,\n  error: any,\n): void {\n  effectUpdateState(name, effect);\n\n  if (reduxDevTools) {\n    reduxDevTools.send(\n      { type: `${name}.fail (effect finished)`, params: parameters, error },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n","/**\n * This is an another entry point for webpack.\n * Be careful with BREAKING CHANGES in this file.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any, @typescript-eslint/unbound-method */\nimport { Domain, is, Scope, Store } from 'effector';\nimport * as inspector from 'effector-inspector';\n\nimport { createName, getPath, watch } from './lib';\nimport * as consoleLogger from './logger';\nimport * as devtools from './redux-devtools';\n\nexport { LOGGER_DOMAIN_NAME } from './lib';\n\ntype Options = {\n  reduxDevtools: 'enabled' | 'disabled';\n  console: 'enabled' | 'disabled';\n  inspector: 'enabled' | 'disabled';\n};\n\nconst defaults: Options = {\n  reduxDevtools: 'enabled',\n  console: 'enabled',\n  inspector: 'enabled',\n};\n\nexport function attachLogger(\n  source: Domain | Scope,\n  logTo: Partial<Options> = {},\n): void {\n  const options = { ...defaults, ...logTo };\n  const isConsole = options.console === 'enabled';\n  const isRedux = options.reduxDevtools === 'enabled';\n  const isInspector = options.inspector === 'enabled';\n\n  function attachEvent(event: any): void {\n    const name = createName(event.compositeName);\n    const fileName = getPath(event);\n\n    if (isConsole) consoleLogger.eventAdded(event);\n    if (isInspector) inspector.addEvent(event);\n\n    watch(event, source, (payload) => {\n      if (isConsole) consoleLogger.eventCalled(name, fileName, payload);\n      if (isRedux) devtools.eventCalled(name, payload);\n    });\n  }\n\n  function attachStore(store: any): void {\n    const name = createName(store.compositeName);\n    const fileName = getPath(store);\n\n    if (isConsole) consoleLogger.storeAdded(store);\n    if (isRedux) devtools.storeAdded(store);\n    if (isInspector) inspector.addStore(store);\n\n    const storeMap = store.map.bind(store);\n\n    store.map = (fn: any, firstState?: any): Store<any> => {\n      const mappedStore = storeMap(fn, firstState);\n\n      mappedStore.compositeName.path = store.compositeName.path.slice(0, -1);\n      mappedStore.compositeName.path.push(\n        store.compositeName.path.slice(-1) + ' -> *',\n      );\n      if (isInspector) inspector.addStore(mappedStore, { mapped: true });\n      return mappedStore;\n    };\n\n    watch(store, source, (value) => {\n      if (isConsole) consoleLogger.storeUpdated(name, fileName, value);\n      if (isRedux) devtools.storeUpdated(name, value);\n    });\n  }\n\n  function attachEffect(effect: any): void {\n    const name = createName(effect.compositeName);\n    const fileName = getPath(effect);\n\n    if (isConsole) consoleLogger.effectAdded(effect);\n    if (isRedux) devtools.effectAdded(name, effect);\n    if (isInspector) inspector.addEffect(effect);\n\n    watch(effect, source, (parameters) => {\n      if (isConsole) consoleLogger.effectCalled(name, fileName, parameters);\n      if (isRedux) devtools.effectCalled(name, effect, parameters);\n    });\n\n    watch(effect.done, source, ({ params, result }) => {\n      if (isConsole) consoleLogger.effectDone(name, fileName, params, result);\n      if (isRedux) devtools.effectDone(name, effect, params, result);\n    });\n\n    watch(effect.fail, source, ({ params, error }) => {\n      if (isConsole) consoleLogger.effectFail(name, fileName, params, error);\n      if (isRedux) devtools.effectFail(name, effect, params, error);\n    });\n  }\n\n  if (is.domain(source)) {\n    source.onCreateEvent(attachEvent);\n    source.onCreateStore(attachStore);\n    source.onCreateEffect(attachEffect);\n  } else {\n    const root = (source as any).cloneOf;\n    if (root === undefined) {\n      throw new Error('Scope should be created from domain');\n    }\n    for (const event of root.history.events) {\n      attachEvent(event);\n    }\n    for (const effect of root.history.effects) {\n      attachEffect(effect);\n    }\n    for (const store of root.history.stores) {\n      attachStore(store);\n    }\n  }\n}\n"],"names":["createName","composite","path","filter","name","join","getPath","unit","defaultConfig","loc","file","watch","source","fn","is","domain","store","getState","updates","watchDomain","scope","node","createNode","step","run","id","graphite","additionalLinks","push","watchScope","SEPARATOR","isNode","storeListToInit","eventListToInit","effectListToInit","styles","effectorLabel","log","blocks","chunks","group","str","params","unshift","forEach","value","view","style","index","count","reset","length","args","console","groupCollapsed","blockNew","stripDomain","split","pop","createBlockStore","createBlockEvent","createBlockEffect","logAdded","debounce","stores","splice","events","effects","compositeName","fileName","event","effect","groupEnd","reduxDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","devToolConfig","instanceId","document","title","rootState","setState","set","replace","effectUpdateState","inFlight","pending","defaults","reduxDevtools","inspector","logTo","options","isConsole","isRedux","isInspector","attachEvent","consoleLogger.eventAdded","addEvent","payload","consoleLogger.eventCalled","send","type","devtools.eventCalled","attachStore","consoleLogger.storeAdded","defaultState","devtools.storeAdded","addStore","storeMap","map","bind","firstState","mappedStore","slice","mapped","consoleLogger.storeUpdated","devtools.storeUpdated","attachEffect","consoleLogger.effectAdded","devtools.effectAdded","addEffect","parameters","consoleLogger.effectCalled","devtools.effectCalled","done","result","consoleLogger.effectDone","devtools.effectDone","fail","error","instanceofError","Error","String","undefined","consoleLogger.effectFail","devtools.effectFail","onCreateEvent","onCreateStore","onCreateEffect","root","cloneOf","history"],"mappings":"4lBAYgBA,EAAWC,GACzB,OAAOA,EAAUC,KAAKC,QAAQC,GAHE,qBAGOA,IAA6BC,KAAK,cAG3DC,EAAQC,aACtB,qCAAQA,EAAaC,oCAAeC,0BAAKC,oBAAQ,aAiCnCC,EACdJ,EACAK,EACAC,GAEIC,KAAGC,OAAOH,GAnChB,SACEL,EACAQ,EACAF,GAEIC,KAAGE,MAAMT,IACXM,EAAGN,EAAKU,aAEQH,KAAGE,MAAMT,GAAQA,EAAKW,QAAUX,GAC/BI,MAAME,GA2BvBM,CAAYZ,EAAMK,EAAQC,GAxB9B,SACEN,EACAa,EACAP,GAEIC,KAAGE,MAAMT,IACXM,EAAGO,EAAMH,SAASV,IAEpB,MAAMc,EAAOC,aAAW,CACtBD,KAAM,CAACE,OAAKC,IAAI,CAAEX,GAAAA,OAGdY,GADYX,KAAGE,MAAMT,GAAQA,EAAKW,QAAUX,GACpBmB,SAASD,IACfL,EAAcO,gBAAgBF,GACnDL,EAAcO,gBAAgBF,IAAO,IAClCG,KAAKP,GAWTQ,CAAWtB,EAAMK,EAAQC,GCpD7B,MAAMiB,EAAYC,UAAS,KAAO,GAE5BC,EAAqC,GACrCC,EAAqC,GACrCC,EAAiD,GAEjDC,EACG,8DADHA,EAEG,8DAFHA,EAMG,yCANHA,EAOG,yCAPHA,EAQI,yCARJA,EASG,GATHA,EAUE,sCAVFA,EAWG,sDAGHC,EAAyB,CAC7B,CAAC,KAAM,KAXL,kGAYF,CAAC,WAAY,KAAM,mCASrB,SAASC,EACPC,EACAC,EACAC,GAEA,MAAMC,EAAgB,GAChBC,EAAgB,GAEtBJ,EAAOK,WAAWP,GAElBE,EAAOM,SAAQ,EAAEC,EAAOC,EAAMC,GAAQC,KACpCP,EAAIb,KAAK,KAAKkB,OACdJ,EAAOd,KACL,GAAGO,KAAgBY,IACnBF,EApBQ,EAACG,EAAeC,EAAeF,IAC3CC,IAAUC,EAAQ,EAAId,EAAeY,EAoBjCG,CAAMF,EAAOV,EAAOa,OAAQ,GAAGhB,KAAgBY,SAInDR,EAAOK,SAAQ,EAAEC,EAAOC,EAAMC,MAC5BN,EAAIb,KAAK,KAAKkB,KACdJ,EAAOd,KAAK,GAAGO,KAAgBY,IAASF,MAG1C,MAAMO,EAAO,CAACX,EAAIpC,KAAKyB,MAAeY,GAExB,SAAVF,EACFa,QAAQb,SAASY,GACE,cAAVZ,EACTa,QAAQC,kBAAkBF,GAE1BC,QAAQhB,OAAOe,GAInB,MAAMG,EAAkB,CAAC,MAAO,KAvDzB,0CA6DDC,EAAepD,GAAiBA,EAAKqD,MAAM,KAAKC,OAAStD,EAEzDuD,EAA6CvD,GAAS,CAACoD,EAAYpD,GAAO,KAAM+B,GAChFyB,EAA8CxD,GAAS,CAACoD,EAAYpD,GAAO,KAAM+B,GACjF0B,EAA8CzD,GAAS,CAACoD,EAAYpD,GAAO,KAAM+B,GAEjF2B,EAAWC,WAAS,KACxB,MAAMC,EAAShC,EAAgBiC,OAAO,GAChCC,EAASjC,EAAgBgC,OAAO,GAChCE,EAAUjC,EAAiB+B,OAAO,GAEpCD,EAAOb,OAASe,EAAOf,OAASgB,EAAQhB,OAAS,IACnDd,EACE,CAACkB,GACD,CACE,CAAC,cAAe,KAAM,IACtB,CAAC,UAAUW,EAAOf,UAAW,KAAM,IACnC,CAAC,WAAWgB,EAAQhB,UAAW,KAAM,IACrC,CAAC,UAAUa,EAAOb,UAAW,KAAM,KAErC,aAGEa,EAAOb,QACTa,EAAOpB,SAAS5B,IACd,MAAMZ,EAAOJ,EAAWgB,EAAMoD,eACxBC,EAAW/D,EAAQU,GAEzBqB,EACE,CAACkB,EAAUI,EAAiBvD,IAC5B,CACE,CAAC,MAAO,KAAM,IACd,CAACY,EAAMC,WAAY,KAAM,IACzB,CAACoD,EAAU,KAAMlC,GACjB,CAAC/B,EAAM,KAAM,SAKjB8D,EAAOf,OAAS,GAClBe,EAAOtB,SAAS0B,IACd,MAAMlE,EAAOJ,EAAWsE,EAAMF,eACxBC,EAAW/D,EAAQgE,GAEzBjC,EACE,CAACkB,EAAUK,EAAiBxD,IAC5B,CACE,CAACiE,EAAU,KAAMlC,GACjB,CAAC/B,EAAM,KAAM,SAKjB+D,EAAQhB,OAAS,GACnBgB,EAAQvB,SAAS2B,IACf,MAAMnE,EAAOJ,EAAWuE,EAAOH,eACzBC,EAAW/D,EAAQiE,GAEzBlC,EACE,CAACkB,EAAUM,EAAkBzD,IAC7B,CACE,CAACiE,EAAU,KAAMlC,GACjB,CAAC/B,EAAM,KAAM,SAKrBiD,QAAQmB,cAET,GC9IH,MAAMC,EAEc,oBAAXC,QAA0BA,OAAOC,6BAS1C,MAAMC,EAAgB,CACpBC,WAPwB,iBAAbC,SACF,MAAMA,SAASC,QAEjB,wBAOHC,EAAiC,GAEvC,SAASC,EAAS7E,EAAcyC,GAC9BqC,UAAIF,EAAW5E,EAAK+E,QAAQ,MAAO,KAAMtC,GAqC3C,SAASuC,EAAkBhF,EAAcmE,GACvCU,EAAS7E,EAAM,CACbiF,SAAUd,EAAOc,SAASpE,WAC1BqE,QAASf,EAAOe,QAAQrE,aC3C5B,MAAMsE,EAAoB,CACxBC,cAAe,UACfnC,QAAS,UACToC,UAAW,sCHbqB,iDGiBhC7E,EACA8E,EAA0B,IAE1B,MAAMC,iCAAeJ,GAAaG,GAC5BE,EAAgC,YAApBD,EAAQtC,QACpBwC,EAAoC,YAA1BF,EAAQH,cAClBM,EAAoC,YAAtBH,EAAQF,UAE5B,SAASM,EAAYzB,GACnB,MAAMlE,EAAOJ,EAAWsE,EAAMF,eACxBC,EAAW/D,EAAQgE,GAErBsB,YFmHmBtB,GACzBrC,EAAgBL,KAAK0C,GACrBR,IErHiBkC,CAAyB1B,GACpCwB,GAAaL,EAAUQ,SAAS3B,GAEpC3D,EAAM2D,EAAO1D,GAASsF,IAChBN,YFsIRxF,EACAiE,EACA6B,GAEA7D,EACE,CAACuB,EAAiBxD,IAClB,CACE,CAAC8F,EAAS,KAAM,sBAChB,CAAC7B,EAAU,KAAMlC,GACjB,CAAC/B,EAAM,KAAM+B,KE/IEgE,CAA0B/F,EAAMiE,EAAU6B,GACrDL,YDlBkBzF,EAAc8F,GACpCzB,GACFA,EAAc2B,KAAK,CACfC,KAAM,GAAGjG,YACT8F,QAAAA,GAEFlB,EACAJ,GCWa0B,CAAqBlG,EAAM8F,MAI5C,SAASK,EAAYvF,GACnB,MAAMZ,EAAOJ,EAAWgB,EAAMoD,eACxBC,EAAW/D,EAAQU,GAErB4E,YFiGmB5E,GACzBgB,EAAgBJ,KAAKZ,GACrB8C,IEnGiB0C,CAAyBxF,GACpC6E,YDfmB7E,GAGzBiE,EAFajF,EAAWgB,EAAMoD,eAEfpD,EAAMyF,cCYNC,CAAoB1F,GAC7B8E,GAAaL,EAAUkB,SAAS3F,GAEpC,MAAM4F,EAAW5F,EAAM6F,IAAIC,KAAK9F,GAEhCA,EAAM6F,IAAM,CAAChG,EAASkG,KACpB,MAAMC,EAAcJ,EAAS/F,EAAIkG,GAOjC,OALAC,EAAY5C,cAAclE,KAAOc,EAAMoD,cAAclE,KAAK+G,MAAM,GAAI,GACpED,EAAY5C,cAAclE,KAAK0B,KAC7BZ,EAAMoD,cAAclE,KAAK+G,OAAO,GAAK,SAEnCnB,GAAaL,EAAUkB,SAASK,EAAa,CAAEE,QAAQ,IACpDF,GAGTrG,EAAMK,EAAOJ,GAASiC,IAChB+C,YF8FmBxF,EAAciE,EAAkBxB,GAC3DR,EACE,CAACsB,EAAiBvD,IAClB,CACE,CAAC,MAAO,KAAM,IACd,CAACyC,EAAO,KAAM,IACd,CAACwB,EAAU,KAAMlC,GACjB,CAAC/B,EAAM,KAAM+B,KErGEgF,CAA2B/G,EAAMiE,EAAUxB,GACtDgD,YD3BmBzF,EAAcyC,GACzCoC,EAAS7E,EAAMyC,GAEX4B,GACFA,EAAc2B,KAAK,CACfC,KAAM,GAAGjG,oBACTyC,MAAAA,GAEFmC,EACAJ,GCkBawC,CAAsBhH,EAAMyC,MAI7C,SAASwE,EAAa9C,GACpB,MAAMnE,EAAOJ,EAAWuE,EAAOH,eACzBC,EAAW/D,EAAQiE,GAErBqB,YFgFoBrB,GAC1BrC,EAAiBN,KAAK2C,GACtBT,IElFiBwD,CAA0B/C,GACrCsB,YDboBzF,EAAcmE,GACxCa,EAAkBhF,EAAMmE,GCYTgD,CAAqBnH,EAAMmE,GACpCuB,GAAaL,EAAU+B,UAAUjD,GAErC5D,EAAM4D,EAAQ3D,GAAS6G,IACjB7B,YF4GRxF,EACAiE,EACAoD,GAEApF,EACE,CAACwB,EAAkBzD,IACnB,CACE,CAACqH,EAAY,KAAM,sBACnB,CAACpD,EAAU,KAAMlC,GACjB,CAAC/B,EAAM,KAAM+B,KErHEuF,CAA2BtH,EAAMiE,EAAUoD,GACtD5B,YDbRzF,EACAmE,EACAkD,GAEArC,EAAkBhF,EAAMmE,GAEpBE,GACFA,EAAc2B,KACZ,CAAEC,KAAM,GAAGjG,oBAAwBsC,OAAQ+E,GAC3CzC,EACAJ,GCGa+C,CAAsBvH,EAAMmE,EAAQkD,MAGnD9G,EAAM4D,EAAOqD,KAAMhH,GAAQ,EAAG8B,OAAAA,EAAQmF,OAAAA,MAChCjC,YFsHRxF,EACAiE,EACAoD,EACAI,GAEAxF,EACE,CAACwB,EAAkBzD,IACnB,CACE,CAAC,SAAU,KAAM+B,GACjB,CAACsF,EAAY,OAAQ,sBACrB,CAAC,MAAO,KAAM,IACd,CAACI,EAAQ,KAAM,eACf,CAACxD,EAAU,KAAMlC,GACjB,CAAC/B,EAAM,KAAM+B,KEnIE2F,CAAyB1H,EAAMiE,EAAU3B,EAAQmF,GAC5DhC,YDFRzF,EACAmE,EACAkD,EACAI,GAEAzC,EAAkBhF,EAAMmE,GAEpBE,GACFA,EAAc2B,KACZ,CAAEC,KAAM,GAAGjG,2BAA+BsC,OAAQ+E,EAAYI,OAAAA,GAC9D7C,EACAJ,GCTamD,CAAoB3H,EAAMmE,EAAQ7B,EAAQmF,MAGzDlH,EAAM4D,EAAOyD,KAAMpH,GAAQ,EAAG8B,OAAAA,EAAQuF,MAAAA,MAChCrC,YFoIRxF,EACAiE,EACAoD,EACAQ,GAEA,MAAMC,EAAkBD,aAAiBE,MAEzC9F,EACE,CAACwB,EAAkBzD,IACnB,CACE,CAAC,SAAU,KAAM+B,GACjB,CAACsF,EAAY,OAAQ,sBACrB,CAAC,MAAO,KAAM,IACdS,EACI,CAACE,OAAOH,GAAQ,KAAM,IACtB,CAACA,EAAO,KAAM,eAClB,CAAC5D,EAAU,KAAMlC,GACjB,CAAC/B,EAAM,KAAM+B,IAEf+F,EAAkB,iBAAcG,GAG9BH,GACF7F,EACE,GACA,CACE,CAAC,IAAK,KAAM,IACZ,CAAC4F,EAAO,KAAM,yBAKpB5E,QAAQmB,WEpKW8D,CAAyBlI,EAAMiE,EAAU3B,EAAQuF,GAC5DpC,YDURzF,EACAmE,EACAkD,EACAQ,GAEA7C,EAAkBhF,EAAMmE,GAEpBE,GACFA,EAAc2B,KACZ,CAAEC,KAAM,GAAGjG,2BAA+BsC,OAAQ+E,EAAYQ,MAAAA,GAC9DjD,EACAJ,GCrBa2D,CAAoBnI,EAAMmE,EAAQ7B,EAAQuF,MAI3D,GAAInH,KAAGC,OAAOH,GACZA,EAAO4H,cAAczC,GACrBnF,EAAO6H,cAAclC,GACrB3F,EAAO8H,eAAerB,OACjB,CACL,MAAMsB,EAAQ/H,EAAegI,QAC7B,QAAaP,IAATM,EACF,MAAM,IAAIR,MAAM,uCAElB,IAAK,MAAM7D,KAASqE,EAAKE,QAAQ3E,OAC/B6B,EAAYzB,GAEd,IAAK,MAAMC,KAAUoE,EAAKE,QAAQ1E,QAChCkD,EAAa9C,GAEf,IAAK,MAAMvD,KAAS2H,EAAKE,QAAQ7E,OAC/BuC,EAAYvF"}