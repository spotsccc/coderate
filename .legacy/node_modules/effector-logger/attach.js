"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("effector"),o=require("effector-inspector"),t=require("just-debounce-it"),n=require("detect-node"),s=require("set-value");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var o=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(o,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),o.default=e,Object.freeze(o)}var r=i(o),l=c(t),a=c(n),f=c(s);function d(e){return e.path.filter((e=>"@effector-logger"!==e)).join("/")}function u(e){var o,t,n;return null!==(n=null===(t=null===(o=e.defaultConfig)||void 0===o?void 0:o.loc)||void 0===t?void 0:t.file)&&void 0!==n?n:" "}function p(o,t,n){e.is.domain(t,{loc:{file:"/src/lib.ts",line:31,column:8},sid:"-5xrbn0"})?function(o,t,n){e.is.store(o,{loc:{file:"/src/lib.ts",line:11,column:8},sid:"-6vukfe"})&&n(o.getState()),(e.is.store(o,{loc:{file:"/src/lib.ts",line:14,column:22},name:"watchUnit",sid:"-tu8c8a"})?o.updates:o).watch(n)}(o,0,n):function(o,t,n){e.is.store(o,{loc:{file:"/src/lib.ts",line:18,column:8},sid:"-6s009v"})&&n(t.getState(o));const s=e.createNode({node:[e.step.run({fn:n})]}),c=(e.is.store(o,{loc:{file:"/src/lib.ts",line:24,column:22},name:"watchUnit",sid:"-f5u209"})?o.updates:o).graphite.id;(t.additionalLinks[c]=t.additionalLinks[c]||[]).push(s)}(o,t,n)}const g=a.default?"  ":"",h=[],m=[],b=[],v="padding-left: 4px; padding-right: 4px; font-weight: normal;",E="padding-left: 4px; padding-right: 4px; font-weight: normal;",y="background-color: #7e57c2; color: #fff",$="background-color: #9ccc65; color: #000",x="background-color: #26a69a; color: #000",N="",w="color: #9e9e9e; padding-left: 20px;",O="color: currentColor; background-color: transparent;",j=[["☄️","%s",'line-height:1.5; color: #000; font-family: "Apple Emoji Font"; font-weight: normal !important;'],["effector","%s","font-family: Menlo, monospace;"]];function S(e,o,t){const n=[],s=[];e.unshift(...j),e.forEach((([o,t,c],i)=>{n.push(`%c${t}%c`),s.push(`${v} ${c}`,o,((e,o,t)=>e===o-1?O:t)(i,e.length,`${v} ${c}`))})),o.forEach((([e,o,t])=>{n.push(`%c${o}`),s.push(`${E} ${t}`,e)}));const c=[n.join(g),...s];"open"===t?console.group(...c):"collapsed"===t?console.groupCollapsed(...c):console.log(...c)}const _=["new","%s","background-color: #29b6f6; color: #000"],k=e=>e.split("/").pop()||e,C=e=>[k(e),"%s",y],D=e=>[k(e),"%s",$],q=e=>[k(e),"%s",x],L=l.default((()=>{const e=h.splice(0),o=m.splice(0),t=b.splice(0);e.length+o.length+t.length>0&&(S([_],[["Initialized","%s",""],[`events(${o.length})`,"%s",""],[`effects(${t.length})`,"%s",""],[`stores(${e.length})`,"%s",""]],"collapsed"),e.length&&e.forEach((e=>{const o=d(e.compositeName),t=u(e);S([_,C(o)],[["-> ","%s",""],[e.getState(),"%o",""],[t,"%s",w],[o,"%s",""]])})),o.length>0&&o.forEach((e=>{const o=d(e.compositeName),t=u(e);S([_,D(o)],[[t,"%s",w],[o,"%s",""]])})),t.length>0&&t.forEach((e=>{const o=d(e.compositeName),t=u(e);S([_,q(o)],[[t,"%s",w],[o,"%s",""]])})),console.groupEnd())}),5);const M="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;const I={instanceId:"object"==typeof document?`☄️ ${document.title}`:"☄️ no title instance"},z={};function A(e,o){f.default(z,e.replace(/\//g,"."),o)}function F(e,o){A(e,{inFlight:o.inFlight.getState(),pending:o.pending.getState()})}const P={reduxDevtools:"enabled",console:"enabled",inspector:"enabled"};exports.LOGGER_DOMAIN_NAME="@effector-logger",exports.attachLogger=function(o,t={}){const n=Object.assign(Object.assign({},P),t),s="enabled"===n.console,c="enabled"===n.reduxDevtools,i="enabled"===n.inspector;function l(e){const t=d(e.compositeName),n=u(e);s&&function(e){m.push(e),L()}(e),i&&r.addEvent(e),p(e,o,(e=>{s&&function(e,o,t){S([D(e)],[[t,"%o","padding-left: 4px;"],[o,"%s",w],[e,"%s",w]])}(t,n,e),c&&function(e,o){M&&M.send({type:`${e} (event)`,payload:o},z,I)}(t,e)}))}function a(e){const t=d(e.compositeName),n=u(e);s&&function(e){h.push(e),L()}(e),c&&function(e){A(d(e.compositeName),e.defaultState)}(e),i&&r.addStore(e);const l=e.map.bind(e);e.map=(o,t)=>{const n=l(o,t);return n.compositeName.path=e.compositeName.path.slice(0,-1),n.compositeName.path.push(e.compositeName.path.slice(-1)+" -> *"),i&&r.addStore(n,{mapped:!0}),n},p(e,o,(e=>{s&&function(e,o,t){S([C(e)],[["-> ","%s",""],[t,"%o",""],[o,"%s",w],[e,"%s",w]])}(t,n,e),c&&function(e,o){A(e,o),M&&M.send({type:`${e} (store updated)`,value:o},z,I)}(t,e)}))}function f(e){const t=d(e.compositeName),n=u(e);s&&function(e){b.push(e),L()}(e),c&&function(e,o){F(e,o)}(t,e),i&&r.addEffect(e),p(e,o,(o=>{s&&function(e,o,t){S([q(e)],[[t,"%o","padding-left: 4px;"],[o,"%s",w],[e,"%s",w]])}(t,n,o),c&&function(e,o,t){F(e,o),M&&M.send({type:`${e} (effect called)`,params:t},z,I)}(t,e,o)})),p(e.done,o,(({params:o,result:i})=>{s&&function(e,o,t,n){S([q(e)],[["done ✅","%s",N],[t,"(%o)","padding-left: 4px;"],["-> ","%s",""],[n,"%o","padding: 0;"],[o,"%s",w],[e,"%s",w]])}(t,n,o,i),c&&function(e,o,t,n){F(e,o),M&&M.send({type:`${e}.done (effect finished)`,params:t,result:n},z,I)}(t,e,o,i)})),p(e.fail,o,(({params:o,error:i})=>{s&&function(e,o,t,n){const s=n instanceof Error;S([q(e)],[["fail ❌","%s",N],[t,"(%o)","padding-left: 4px;"],["-> ","%s",""],s?[String(n),"%s",""]:[n,"%o","padding: 0;"],[o,"%s",w],[e,"%s",w]],s?"collapsed":void 0),s&&S([],[[" ","%s",""],[n,"%o","padding-left: 20px;"]]),console.groupEnd()}(t,n,o,i),c&&function(e,o,t,n){F(e,o),M&&M.send({type:`${e}.fail (effect finished)`,params:t,error:n},z,I)}(t,e,o,i)}))}if(e.is.domain(o,{loc:{file:"/src/attach.ts",line:89,column:8},sid:"4o82wz"}))o.onCreateEvent(l),o.onCreateStore(a),o.onCreateEffect(f);else{const e=o.cloneOf;if(void 0===e)throw new Error("Scope should be created from domain");for(const o of e.history.events)l(o);for(const o of e.history.effects)f(o);for(const o of e.history.stores)a(o)}};
//# sourceMappingURL=attach.js.map
